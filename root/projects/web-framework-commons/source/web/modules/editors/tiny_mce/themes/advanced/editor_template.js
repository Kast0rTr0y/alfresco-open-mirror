(function(i){var j=i.DOM,h=i.dom.Event,c=i.extend,g=i.each,a=i.util.Cookie,f,d=i.explode;function b(n,l){var r,q=n.dom,o="",p,m;previewStyles=n.settings.preview_styles;if(previewStyles===false){return""}if(!previewStyles){previewStyles="font-family font-size font-weight text-decoration text-transform color background-color"}function k(s){return s.replace(/%(\w+)/g,"")}name=l.block||l.inline||"span";r=q.create(name);g(l.styles,function(t,s){t=k(t);if(t){q.setStyle(r,s,t)}});g(l.attributes,function(t,s){t=k(t);if(t){q.setAttrib(r,s,t)}});g(l.classes,function(s){s=k(s);if(!q.hasClass(r,s)){q.addClass(r,s)}});q.setStyles(r,{position:"absolute",left:-65535});n.getBody().appendChild(r);p=q.getStyle(n.getBody(),"fontSize",true);p=/px$/.test(p)?parseInt(p,10):0;g(previewStyles.split(" "),function(s){var t=q.getStyle(r,s,true);if(s=="background-color"&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(t)){t=q.getStyle(n.getBody(),s,true);if(q.toHex(t).toLowerCase()=="#ffffff"){return}}if(s=="font-size"){if(/em|%$/.test(t)){if(p===0){return}t=parseFloat(t,10)/(/%$/.test(t)?100:1);t=(t*p)+"px"}}o+=s+":"+t+";"});q.remove(r);return o}i.ThemeManager.requireLangPack("advanced");i.create("tinymce.themes.AdvancedTheme",{sizes:[8,10,12,14,18,24,36],controls:{bold:["bold_desc","Bold"],italic:["italic_desc","Italic"],underline:["underline_desc","Underline"],strikethrough:["striketrough_desc","Strikethrough"],justifyleft:["justifyleft_desc","JustifyLeft"],justifycenter:["justifycenter_desc","JustifyCenter"],justifyright:["justifyright_desc","JustifyRight"],justifyfull:["justifyfull_desc","JustifyFull"],bullist:["bullist_desc","InsertUnorderedList"],numlist:["numlist_desc","InsertOrderedList"],outdent:["outdent_desc","Outdent"],indent:["indent_desc","Indent"],cut:["cut_desc","Cut"],copy:["copy_desc","Copy"],paste:["paste_desc","Paste"],undo:["undo_desc","Undo"],redo:["redo_desc","Redo"],link:["link_desc","mceLink"],unlink:["unlink_desc","unlink"],image:["image_desc","mceImage"],cleanup:["cleanup_desc","mceCleanup"],help:["help_desc","mceHelp"],code:["code_desc","mceCodeEditor"],hr:["hr_desc","InsertHorizontalRule"],removeformat:["removeformat_desc","RemoveFormat"],sub:["sub_desc","subscript"],sup:["sup_desc","superscript"],forecolor:["forecolor_desc","ForeColor"],forecolorpicker:["forecolor_desc","mceForeColor"],backcolor:["backcolor_desc","HiliteColor"],backcolorpicker:["backcolor_desc","mceBackColor"],charmap:["charmap_desc","mceCharMap"],visualaid:["visualaid_desc","mceToggleVisualAid"],anchor:["anchor_desc","mceInsertAnchor"],newdocument:["newdocument_desc","mceNewDocument"],blockquote:["blockquote_desc","mceBlockQuote"]},stateControls:["bold","italic","underline","strikethrough","bullist","numlist","justifyleft","justifycenter","justifyright","justifyfull","sub","sup","blockquote"],init:function(l,m){var n=this,p,k,q;n.editor=l;n.url=m;n.onResolveName=new i.util.Dispatcher(this);l.forcedHighContrastMode=l.settings.detect_highcontrast&&n._isHighContrast();l.settings.skin=l.forcedHighContrastMode?"highcontrast":l.settings.skin;n.settings=p=c({theme_advanced_path:true,theme_advanced_toolbar_location:"bottom",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,styleselect,formatselect",theme_advanced_buttons2:"bullist,numlist,|,outdent,indent,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code",theme_advanced_buttons3:"hr,removeformat,visualaid,|,sub,sup,|,charmap",theme_advanced_blockformats:"p,address,pre,h1,h2,h3,h4,h5,h6",theme_advanced_toolbar_align:"center",theme_advanced_fonts:"Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats",theme_advanced_more_colors:1,theme_advanced_row_height:23,theme_advanced_resize_horizontal:1,theme_advanced_resizing_use_cookie:1,theme_advanced_font_sizes:"1,2,3,4,5,6,7",theme_advanced_font_selector:"span",theme_advanced_show_current_color:0,readonly:l.settings.readonly},l.settings);if(!p.font_size_style_values){p.font_size_style_values="8pt,10pt,12pt,14pt,18pt,24pt,36pt"}if(i.is(p.theme_advanced_font_sizes,"string")){p.font_size_style_values=i.explode(p.font_size_style_values);p.font_size_classes=i.explode(p.font_size_classes||"");q={};l.settings.theme_advanced_font_sizes=p.theme_advanced_font_sizes;g(l.getParam("theme_advanced_font_sizes","","hash"),function(s,r){var o;if(r==s&&s>=1&&s<=7){r=s+" ("+n.sizes[s-1]+"pt)";o=p.font_size_classes[s-1];s=p.font_size_style_values[s-1]||(n.sizes[s-1]+"pt")}if(/^\s*\./.test(s)){o=s.replace(/\./g,"")}q[r]=o?{"class":o}:{fontSize:s}});p.theme_advanced_font_sizes=q}if((k=p.theme_advanced_path_location)&&k!="none"){p.theme_advanced_statusbar_location=p.theme_advanced_path_location}if(p.theme_advanced_statusbar_location=="none"){p.theme_advanced_statusbar_location=0}if(l.settings.content_css!==false){l.contentCSS.push(l.baseURI.toAbsolute(m+"/skins/"+l.settings.skin+"/content.css"))}l.onInit.add(function(){if(!l.settings.readonly){l.onNodeChange.add(n._nodeChanged,n);l.onKeyUp.add(n._updateUndoStatus,n);l.onMouseUp.add(n._updateUndoStatus,n);l.dom.bind(l.dom.getRoot(),"dragend",function(){n._updateUndoStatus(l)})}});l.onSetProgressState.add(function(s,o,t){var u,v=s.id,r;if(o){n.progressTimer=setTimeout(function(){u=s.getContainer();u=u.insertBefore(j.create("DIV",{style:"position:relative"}),u.firstChild);r=j.get(s.id+"_tbl");j.add(u,"div",{id:v+"_blocker","class":"mceBlocker",style:{width:r.clientWidth+2,height:r.clientHeight+2}});j.add(u,"div",{id:v+"_progress","class":"mceProgress",style:{left:r.clientWidth/2,top:r.clientHeight/2}})},t||0)}else{j.remove(v+"_blocker");j.remove(v+"_progress");clearTimeout(n.progressTimer)}});j.loadCSS(p.editor_css?l.documentBaseURI.toAbsolute(p.editor_css):m+"/skins/"+l.settings.skin+"/ui.css");if(p.skin_variant){j.loadCSS(m+"/skins/"+l.settings.skin+"/ui_"+p.skin_variant+".css")}},_isHighContrast:function(){var k,l=j.add(j.getRoot(),"div",{style:"background-color: rgb(171,239,86);"});k=(j.getStyle(l,"background-color",true)+"").toLowerCase().replace(/ /g,"");j.remove(l);return k!="rgb(171,239,86)"&&k!="#abef56"},createControl:function(o,k){var l,m;if(m=k.createControl(o)){return m}switch(o){case"styleselect":return this._createStyleSelect();case"formatselect":return this._createBlockFormats();case"fontselect":return this._createFontSelect();case"fontsizeselect":return this._createFontSizeSelect();case"forecolor":return this._createForeColorMenu();case"backcolor":return this._createBackColorMenu()}if((l=this.controls[o])){return k.createButton(o,{title:"advanced."+l[0],cmd:l[1],ui:l[2],value:l[3]})}},execCommand:function(m,l,n){var k=this["_"+m];if(k){k.call(this,l,n);return true}return false},_importClasses:function(m){var k=this.editor,l=k.controlManager.get("styleselect");if(l.getLength()==0){g(k.dom.getClasses(),function(r,n){var q="style_"+n,p;p={inline:"span",attributes:{"class":r["class"]},selector:"*"};k.formatter.register(q,p);l.add(r["class"],q,{style:function(){return b(k,p)}})})}},_createStyleSelect:function(p){var m=this,k=m.editor,l=k.controlManager,o;o=l.createListBox("styleselect",{title:"advanced.style_select",onselect:function(r){var s,n=[],q;g(o.items,function(t){n.push(t.value)});k.focus();k.undoManager.add();s=k.formatter.matchAll(n);i.each(s,function(t){if(!r||t==r){if(t){k.formatter.remove(t)}q=true}});if(!q){k.formatter.apply(r)}k.undoManager.add();k.nodeChanged();return false}});k.onPreInit.add(function(){var q=0,n=k.getParam("style_formats");if(n){g(n,function(r){var s,t=0;g(r,function(){t++});if(t>1){s=r.name=r.name||"style_"+(q++);k.formatter.register(s,r);o.add(r.title,s,{style:function(){return b(k,r)}})}else{o.add(r.title)}})}else{g(k.getParam("theme_advanced_styles","","hash"),function(u,t){var s,r;if(u){s="style_"+(q++);r={inline:"span",classes:u,selector:"*"};k.formatter.register(s,r);o.add(m.editor.translate(t),s,{style:function(){return b(k,r)}})}})}});if(o.getLength()==0){o.onPostRender.add(function(q,r){if(!o.NativeListBox){h.add(r.id+"_text","focus",m._importClasses,m);h.add(r.id+"_text","mousedown",m._importClasses,m);h.add(r.id+"_open","focus",m._importClasses,m);h.add(r.id+"_open","mousedown",m._importClasses,m)}else{h.add(r.id,"focus",m._importClasses,m)}})}return o},_createFontSelect:function(){var m,l=this,k=l.editor;m=k.controlManager.createListBox("fontselect",{title:"advanced.fontdefault",onselect:function(n){var o=m.items[m.selectedIndex];if(!n&&o){k.execCommand("FontName",false,o.value);return}k.execCommand("FontName",false,n);m.select(function(p){return n==p});if(o&&o.value==n){m.select(null)}return false}});if(m){g(k.getParam("theme_advanced_fonts",l.settings.theme_advanced_fonts,"hash"),function(o,n){m.add(k.translate(n),o,{style:o.indexOf("dings")==-1?"font-family:"+o:""})})}return m},_createFontSizeSelect:function(){var n=this,l=n.editor,o,m=0,k=[];o=l.controlManager.createListBox("fontsizeselect",{title:"advanced.font_size",onselect:function(p){var q=o.items[o.selectedIndex];if(!p&&q){q=q.value;if(q["class"]){l.formatter.toggle("fontsize_class",{value:q["class"]});l.undoManager.add();l.nodeChanged()}else{l.execCommand("FontSize",false,q.fontSize)}return}if(p["class"]){l.focus();l.undoManager.add();l.formatter.toggle("fontsize_class",{value:p["class"]});l.undoManager.add();l.nodeChanged()}else{l.execCommand("FontSize",false,p.fontSize)}o.select(function(r){return p==r});if(q&&(q.value.fontSize==p.fontSize||q.value["class"]&&q.value["class"]==p["class"])){o.select(null)}return false}});if(o){g(n.settings.theme_advanced_font_sizes,function(q,p){var r=q.fontSize;if(r>=1&&r<=7){r=n.sizes[parseInt(r)-1]+"pt"}o.add(p,q,{style:"font-size:"+r,"class":"mceFontSize"+(m++)+(" "+(q["class"]||""))})})}return o},_createBlockFormats:function(){var m,k={p:"advanced.paragraph",address:"advanced.address",pre:"advanced.pre",h1:"advanced.h1",h2:"advanced.h2",h3:"advanced.h3",h4:"advanced.h4",h5:"advanced.h5",h6:"advanced.h6",div:"advanced.div",blockquote:"advanced.blockquote",code:"advanced.code",dt:"advanced.dt",dd:"advanced.dd",samp:"advanced.samp"},l=this;m=l.editor.controlManager.createListBox("formatselect",{title:"advanced.block",onselect:function(n){l.editor.execCommand("FormatBlock",false,n);return false}});if(m){g(l.editor.getParam("theme_advanced_blockformats",l.settings.theme_advanced_blockformats,"hash"),function(o,n){m.add(l.editor.translate(n!=o?n:k[o]),o,{"class":"mce_formatPreview mce_"+o,style:function(){return b(l.editor,{block:o})}})})}return m},_createForeColorMenu:function(){var p,l=this,m=l.settings,n={},k;if(m.theme_advanced_more_colors){n.more_colors_func=function(){l._mceColorPicker(0,{color:p.value,func:function(o){p.setColor(o)}})}}if(k=m.theme_advanced_text_colors){n.colors=k}if(m.theme_advanced_default_foreground_color){n.default_color=m.theme_advanced_default_foreground_color}n.title="advanced.forecolor_desc";n.cmd="ForeColor";n.scope=this;p=l.editor.controlManager.createColorSplitButton("forecolor",n);return p},_createBackColorMenu:function(){var p,l=this,m=l.settings,n={},k;if(m.theme_advanced_more_colors){n.more_colors_func=function(){l._mceColorPicker(0,{color:p.value,func:function(o){p.setColor(o)}})}}if(k=m.theme_advanced_background_colors){n.colors=k}if(m.theme_advanced_default_background_color){n.default_color=m.theme_advanced_default_background_color}n.title="advanced.backcolor_desc";n.cmd="HiliteColor";n.scope=this;p=l.editor.controlManager.createColorSplitButton("backcolor",n);return p},renderUI:function(m){var r,q,u,x=this,v=x.editor,y=x.settings,w,l,k;if(v.settings){v.settings.aria_label=y.aria_label+v.getLang("advanced.help_shortcut")}r=l=j.create("span",{role:"application","aria-labelledby":v.id+"_voice",id:v.id+"_parent","class":"mceEditor "+v.settings.skin+"Skin"+(y.skin_variant?" "+v.settings.skin+"Skin"+x._ufirst(y.skin_variant):"")+(v.settings.directionality=="rtl"?" mceRtl":"")});j.add(r,"span",{"class":"mceVoiceLabel",style:"display:none;",id:v.id+"_voice"},y.aria_label);if(!j.boxModel){r=j.add(r,"div",{"class":"mceOldBoxModel"})}r=w=j.add(r,"table",{role:"presentation",id:v.id+"_tbl","class":"mceLayout",cellSpacing:0,cellPadding:0});r=u=j.add(r,"tbody");switch((y.theme_advanced_layout_manager||"").toLowerCase()){case"rowlayout":q=x._rowLayout(y,u,m);break;case"customlayout":q=v.execCallback("theme_advanced_custom_layout",y,u,m,l);break;default:q=x._simpleLayout(y,u,m,l)}r=m.targetNode;k=w.rows;j.addClass(k[0],"mceFirst");j.addClass(k[k.length-1],"mceLast");g(j.select("tr",u),function(o){j.addClass(o.firstChild,"mceFirst");j.addClass(o.childNodes[o.childNodes.length-1],"mceLast")});if(j.get(y.theme_advanced_toolbar_container)){j.get(y.theme_advanced_toolbar_container).appendChild(l)}else{j.insertAfter(l,r)}h.add(v.id+"_path_row","click",function(n){n=n.target;if(n.nodeName=="A"){x._sel(n.className.replace(/^.*mcePath_([0-9]+).*$/,"$1"));return false}});if(!v.getParam("accessibility_focus")){h.add(j.add(l,"a",{href:"#"},"<!-- IE -->"),"focus",function(){tinyMCE.get(v.id).focus()})}if(y.theme_advanced_toolbar_location=="external"){m.deltaHeight=0}x.deltaHeight=m.deltaHeight;m.targetNode=null;v.onKeyDown.add(function(p,n){var s=121,o=122;if(n.altKey){if(n.keyCode===s){if(i.isWebKit){window.focus()}x.toolbarGroup.focus();return h.cancel(n)}else{if(n.keyCode===o){j.get(p.id+"_path_row").focus();return h.cancel(n)}}}});v.addShortcut("alt+0","","mceShortcuts",x);YUIEvent.on(window,"resize",function(){e=j.get(v.id+"_tbl");this.resizeHeaderFooter(e)},this,true);return{iframeContainer:q,editorContainer:v.id+"_parent",sizeContainer:w,deltaHeight:m.deltaHeight}},getInfo:function(){return{longname:"Advanced theme",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",version:i.majorVersion+"."+i.minorVersion}},resizeBy:function(k,l){var m=j.get(this.editor.id+"_ifr");this.resizeTo(m.clientWidth+k,m.clientHeight+l)},resizeTo:function(k,o,m){var l=this.editor,n=this.settings,p=j.get(l.id+"_tbl"),q=j.get(l.id+"_ifr");k=Math.max(n.theme_advanced_resizing_min_width||100,k);o=Math.max(n.theme_advanced_resizing_min_height||100,o);k=Math.min(n.theme_advanced_resizing_max_width||65535,k);o=Math.min(n.theme_advanced_resizing_max_height||65535,o);j.setStyle(p,"height","");j.setStyle(q,"height",o);if(n.theme_advanced_resize_horizontal){j.setStyle(p,"width","");j.setStyle(q,"width",k);if(k<p.clientWidth){k=p.clientWidth;j.setStyle(q,"width",p.clientWidth)}this.resizeHeaderFooter(p)}if(m&&n.theme_advanced_resizing_use_cookie){a.setHash("TinyMCE_"+l.id+"_size",{cw:k,ch:o})}},resizeHeaderFooter:function(k){header=j.get("alf-hd");footer=j.get("alf-ft");docWidth=YUIDom.getViewportWidth();widthHeader=parseInt(YUIDom.getStyle(header,"width"),10);widthFooter=parseInt(YUIDom.getStyle(footer,"width"),10);regionTable=YUIDom.getRegion(k);inequality=(regionTable.left+regionTable.width)-widthFooter;valueFooter=widthFooter+inequality;valueHeader=widthHeader+inequality;if(inequality>0||(inequality<0&&valueFooter>docWidth)){YUIDom.setStyle(header,"width",valueHeader+"px");YUIDom.setStyle(footer,"width",valueFooter+"px")}else{if(valueFooter<=docWidth){YUIDom.setStyle(header,"width",docWidth-20+"px");YUIDom.setStyle(footer,"width",docWidth+"px")}}},destroy:function(){var k=this.editor.id;h.clear(k+"_resize");h.clear(k+"_path_row");h.clear(k+"_external_close")},_simpleLayout:function(A,v,m,k){var z=this,w=z.editor,x=A.theme_advanced_toolbar_location,r=A.theme_advanced_statusbar_location,q,l,u,y;if(A.readonly){q=j.add(v,"tr");q=l=j.add(q,"td",{"class":"mceIframeContainer"});return l}if(x=="top"){z._addToolbars(v,m)}if(x=="external"){q=y=j.create("div",{style:"position:relative"});q=j.add(q,"div",{id:w.id+"_external","class":"mceExternalToolbar"});j.add(q,"a",{id:w.id+"_external_close",href:"javascript:;","class":"mceExternalClose"});q=j.add(q,"table",{id:w.id+"_tblext",cellSpacing:0,cellPadding:0});u=j.add(q,"tbody");if(k.firstChild.className=="mceOldBoxModel"){k.firstChild.appendChild(y)}else{k.insertBefore(y,k.firstChild)}z._addToolbars(u,m);w.onMouseUp.add(function(){var o=j.get(w.id+"_external");j.show(o);j.hide(f);var n=h.add(w.id+"_external_close","click",function(){j.hide(w.id+"_external");h.remove(w.id+"_external_close","click",n)});j.show(o);j.setStyle(o,"top",0-j.getRect(w.id+"_tblext").h-1);j.hide(o);j.show(o);o.style.filter="";f=w.id+"_external";o=null})}if(r=="top"){z._addStatusBar(v,m)}if(!A.theme_advanced_toolbar_container){q=j.add(v,"tr");q=l=j.add(q,"td",{"class":"mceIframeContainer"})}if(x=="bottom"){z._addToolbars(v,m)}if(r=="bottom"){z._addStatusBar(v,m)}return l},_rowLayout:function(y,q,m){var x=this,r=x.editor,w,z,k=r.controlManager,p,l,v,u;w=y.theme_advanced_containers_default_class||"";z=y.theme_advanced_containers_default_align||"center";g(d(y.theme_advanced_containers||""),function(s,o){var n=y["theme_advanced_container_"+s]||"";switch(s.toLowerCase()){case"mceeditor":p=j.add(q,"tr");p=l=j.add(p,"td",{"class":"mceIframeContainer"});break;case"mceelementpath":x._addStatusBar(q,m);break;default:u=(y["theme_advanced_container_"+s+"_align"]||z).toLowerCase();u="mce"+x._ufirst(u);p=j.add(j.add(q,"tr"),"td",{"class":"mceToolbar "+(y["theme_advanced_container_"+s+"_class"]||w)+" "+u||z});v=k.createToolbar("toolbar"+o);x._addControls(n,v);j.setHTML(p,v.renderHTML());m.deltaHeight-=y.theme_advanced_row_height}});return l},_addControls:function(l,k){var m=this,n=m.settings,o,p=m.editor.controlManager;if(n.theme_advanced_disable&&!m._disabled){o={};g(d(n.theme_advanced_disable),function(q){o[q]=1});m._disabled=o}else{o=m._disabled}g(d(l),function(r){var q;if(o&&o[r]){return}if(r=="tablecontrols"){g(["table","|","row_props","cell_props","|","row_before","row_after","delete_row","|","col_before","col_after","delete_col","|","split_cells","merge_cells"],function(s){s=m.createControl(s,p);if(s){k.add(s)}});return}q=m.createControl(r,p);if(q){k.add(q)}})},_addToolbars:function(z,l){var C=this,r,q,w=C.editor,D=C.settings,B,k=w.controlManager,x,m,u=[],A,y,p=false;y=k.createToolbarGroup("toolbargroup",{name:w.getLang("advanced.toolbar"),tab_focus_toolbar:w.getParam("theme_advanced_tab_focus_toolbar")});C.toolbarGroup=y;A=D.theme_advanced_toolbar_align.toLowerCase();A="mce"+C._ufirst(A);m=j.add(j.add(z,"tr",{role:"presentation"}),"td",{"class":"mceToolbar "+A,role:"presentation"});for(r=1;(B=D["theme_advanced_buttons"+r]);r++){p=true;q=k.createToolbar("toolbar"+r,{"class":"mceToolbarRow"+r});if(D["theme_advanced_buttons"+r+"_add"]){B+=","+D["theme_advanced_buttons"+r+"_add"]}if(D["theme_advanced_buttons"+r+"_add_before"]){B=D["theme_advanced_buttons"+r+"_add_before"]+","+B}C._addControls(B,q);y.add(q);l.deltaHeight-=D.theme_advanced_row_height}if(!p){l.deltaHeight-=D.theme_advanced_row_height}u.push(y.renderHTML());u.push(j.createHTML("a",{href:"#",accesskey:"z",title:w.getLang("advanced.toolbar_focus"),onfocus:"tinyMCE.getInstanceById('"+w.id+"').focus();"},"<!-- IE -->"));j.setHTML(m,u.join(""))},_addStatusBar:function(q,l){var m,x=this,u=x.editor,y=x.settings,k,v,w,p;m=j.add(q,"tr");m=p=j.add(m,"td",{"class":"mceStatusbar"});m=j.add(m,"div",{id:u.id+"_path_row",role:"group","aria-labelledby":u.id+"_path_voice"});if(y.theme_advanced_path){j.add(m,"span",{id:u.id+"_path_voice"},u.translate("advanced.path"));j.add(m,"span",{},": ")}else{j.add(m,"span",{},"&#160;")}if(y.theme_advanced_resizing){j.add(p,"a",{id:u.id+"_resize",href:"javascript:;",onclick:"return false;","class":"mceResize",tabIndex:"-1"});if(y.theme_advanced_resizing_use_cookie){u.onPostRender.add(function(){var n=a.getHash("TinyMCE_"+u.id+"_size"),r=j.get(u.id+"_tbl");if(!n){return}x.resizeTo(n.cw,n.ch)})}u.onPostRender.add(function(){h.add(u.id+"_resize","click",function(n){n.preventDefault()});h.add(u.id+"_resize","mousedown",function(F){var t,r,s,o,E,B,C,H,n,G,z;function A(I){I.preventDefault();n=C+(I.screenX-E);G=H+(I.screenY-B);x.resizeTo(n,G)}function D(I){h.remove(j.doc,"mousemove",t);h.remove(u.getDoc(),"mousemove",r);h.remove(j.doc,"mouseup",s);h.remove(u.getDoc(),"mouseup",o);n=C+(I.screenX-E);G=H+(I.screenY-B);x.resizeTo(n,G,true)}F.preventDefault();E=F.screenX;B=F.screenY;z=j.get(x.editor.id+"_ifr");C=n=z.clientWidth;H=G=z.clientHeight;t=h.add(j.doc,"mousemove",A);r=h.add(u.getDoc(),"mousemove",A);s=h.add(j.doc,"mouseup",D);o=h.add(u.getDoc(),"mouseup",D)})})}l.deltaHeight-=21;m=q=null},_updateUndoStatus:function(l){var k=l.controlManager,m=l.undoManager;k.setDisabled("undo",!m.hasUndo()&&!m.typing);k.setDisabled("redo",!m.hasRedo())},_nodeChanged:function(q,w,F,u,G){var A=this,E,H=0,z,I,B=A.settings,y,m,x,D,o,l,k;i.each(A.stateControls,function(n){w.setActive(n,q.queryCommandState(A.controls[n][1]))});function r(p){var s,n=G.parents,t=p;if(typeof(p)=="string"){t=function(v){return v.nodeName==p}}for(s=0;s<n.length;s++){if(t(n[s])){return n[s]}}}w.setActive("visualaid",q.hasVisual);A._updateUndoStatus(q);w.setDisabled("outdent",!q.queryCommandState("Outdent"));E=r("A");if(I=w.get("link")){if(!E||!E.name){I.setDisabled(!E&&u);I.setActive(!!E)}}if(I=w.get("unlink")){I.setDisabled(!E&&u);I.setActive(!!E&&!E.name)}if(I=w.get("anchor")){I.setActive(!u&&!!E&&E.name)}E=r("IMG");if(I=w.get("image")){I.setActive(!u&&!!E&&F.className.indexOf("mceItem")==-1)}if(I=w.get("styleselect")){A._importClasses();l=[];g(I.items,function(n){l.push(n.value)});k=q.formatter.matchAll(l);I.select(k[0]);i.each(k,function(p,n){if(n>0){I.mark(p)}})}if(I=w.get("formatselect")){E=r(q.dom.isBlock);if(E){I.select(E.nodeName.toLowerCase())}}r(function(p){if(p.nodeName==="SPAN"){if(!y&&p.className){y=p.className}}if(q.dom.is(p,B.theme_advanced_font_selector)){if(!m&&p.style.fontSize){m=p.style.fontSize}if(!x&&p.style.fontFamily){x=p.style.fontFamily.replace(/[\"\']+/g,"").replace(/^([^,]+).*/,"$1").toLowerCase()}if(!D&&p.style.color){D=p.style.color}if(!o&&p.style.backgroundColor){o=p.style.backgroundColor}}return false});if(I=w.get("fontselect")){I.select(function(n){return n.replace(/^([^,]+).*/,"$1").toLowerCase()==x})}if(I=w.get("fontsizeselect")){if(B.theme_advanced_runtime_fontsize&&!m&&!y){m=q.dom.getStyle(F,"fontSize",true)}I.select(function(n){if(n.fontSize&&n.fontSize===m){return true}if(n["class"]&&n["class"]===y){return true}})}if(B.theme_advanced_show_current_color){function C(p,n){if(I=w.get(p)){if(!n){n=I.settings.default_color}if(n!==I.value){I.displayColor(n)}}}C("forecolor",D);C("backcolor",o)}if(B.theme_advanced_show_current_color){function C(p,n){if(I=w.get(p)){if(!n){n=I.settings.default_color}if(n!==I.value){I.displayColor(n)}}}C("forecolor",D);C("backcolor",o)}if(B.theme_advanced_path&&B.theme_advanced_statusbar_location){E=j.get(q.id+"_path")||j.add(q.id+"_path_row","span",{id:q.id+"_path"});if(A.statusKeyboardNavigation){A.statusKeyboardNavigation.destroy();A.statusKeyboardNavigation=null}j.setHTML(E,"");r(function(J){var p=J.nodeName.toLowerCase(),s,v,t="";if(J.nodeType!=1||p==="br"||J.getAttribute("data-mce-bogus")||j.hasClass(J,"mceItemHidden")||j.hasClass(J,"mceItemRemoved")){return}if(i.isIE&&J.scopeName!=="HTML"&&J.scopeName){p=J.scopeName+":"+p}p=p.replace(/mce\:/g,"");switch(p){case"b":p="strong";break;case"i":p="em";break;case"img":if(z=j.getAttrib(J,"src")){t+="src: "+z+" "}break;case"a":if(z=j.getAttrib(J,"name")){t+="name: "+z+" ";p+="#"+z}if(z=j.getAttrib(J,"href")){t+="href: "+z+" "}break;case"font":if(z=j.getAttrib(J,"face")){t+="font: "+z+" "}if(z=j.getAttrib(J,"size")){t+="size: "+z+" "}if(z=j.getAttrib(J,"color")){t+="color: "+z+" "}break;case"span":if(z=j.getAttrib(J,"style")){t+="style: "+z+" "}break}if(z=j.getAttrib(J,"id")){t+="id: "+z+" "}if(z=J.className){z=z.replace(/\b\s*(webkit|mce|Apple-)\w+\s*\b/g,"");if(z){t+="class: "+z+" ";if(q.dom.isBlock(J)||p=="img"||p=="span"){p+="."+z}}}p=p.replace(/(html:)/g,"");p={name:p,node:J,title:t};A.onResolveName.dispatch(A,p);t=p.title;p=p.name;v=j.create("a",{href:"javascript:;",role:"button",onmousedown:"return false;",title:t,"class":"mcePath_"+(H++)},p);if(E.hasChildNodes()){E.insertBefore(j.create("span",{"aria-hidden":"true"},"\u00a0\u00bb "),E.firstChild);E.insertBefore(v,E.firstChild)}else{E.appendChild(v)}},q.getBody());if(j.select("a",E).length>0){A.statusKeyboardNavigation=new i.ui.KeyboardNavigation({root:q.id+"_path_row",items:j.select("a",E),excludeFromTabOrder:true,onCancel:function(){q.focus()}},j)}}},_sel:function(k){this.editor.execCommand("mceSelectNodeDepth",false,k)},_mceInsertAnchor:function(m,l){var k=this.editor;k.windowManager.open({url:this.url+"/anchor.htm",width:320+parseInt(k.getLang("advanced.anchor_delta_width",0)),height:90+parseInt(k.getLang("advanced.anchor_delta_height",0)),inline:true},{theme_url:this.url})},_mceCharMap:function(){var k=this.editor;k.windowManager.open({url:this.url+"/charmap.htm",width:550+parseInt(k.getLang("advanced.charmap_delta_width",0)),height:265+parseInt(k.getLang("advanced.charmap_delta_height",0)),inline:true},{theme_url:this.url})},_mceHelp:function(){var k=this.editor;k.windowManager.open({url:this.url+"/about.htm",width:480,height:380,inline:true},{theme_url:this.url})},_mceShortcuts:function(){var k=this.editor;k.windowManager.open({url:this.url+"/shortcuts.htm",width:480,height:380,inline:true},{theme_url:this.url})},_mceColorPicker:function(m,l){var k=this.editor;l=l||{};k.windowManager.open({url:this.url+"/color_picker.htm",width:375+parseInt(k.getLang("advanced.colorpicker_delta_width",0)),height:250+parseInt(k.getLang("advanced.colorpicker_delta_height",0)),close_previous:false,inline:true},{input_color:l.color,func:l.func,theme_url:this.url})},_mceCodeEditor:function(l,m){var k=this.editor;k.windowManager.open({url:this.url+"/source_editor.htm",width:parseInt(k.getParam("theme_advanced_source_editor_width",720)),height:parseInt(k.getParam("theme_advanced_source_editor_height",580)),inline:true,resizable:true,maximizable:true},{theme_url:this.url})},_mceImage:function(l,m){var k=this.editor;if(k.dom.getAttrib(k.selection.getNode(),"class","").indexOf("mceItem")!=-1){return}k.windowManager.open({url:this.url+"/image.htm",width:355+parseInt(k.getLang("advanced.image_delta_width",0)),height:275+parseInt(k.getLang("advanced.image_delta_height",0)),inline:true},{theme_url:this.url})},_mceLink:function(l,m){var k=this.editor;k.windowManager.open({url:this.url+"/link.htm",width:310+parseInt(k.getLang("advanced.link_delta_width",0)),height:200+parseInt(k.getLang("advanced.link_delta_height",0)),inline:true},{theme_url:this.url})},_mceNewDocument:function(){var k=this.editor;k.windowManager.confirm("advanced.newdocument",function(l){if(l){k.execCommand("mceSetContent",false,"")}})},_mceForeColor:function(){var k=this;this._mceColorPicker(0,{color:k.fgColor,func:function(l){k.fgColor=l;k.editor.execCommand("ForeColor",false,l)}})},_mceBackColor:function(){var k=this;this._mceColorPicker(0,{color:k.bgColor,func:function(l){k.bgColor=l;k.editor.execCommand("HiliteColor",false,l)}})},_ufirst:function(k){return k.substring(0,1).toUpperCase()+k.substring(1)}});i.ThemeManager.add("advanced",i.themes.AdvancedTheme)}(tinymce));