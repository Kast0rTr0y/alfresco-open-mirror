<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">
    
    <!-- Note that there is no "Forgotten Password" Service. There are only the REST API and these Activiti delegate beans
         Ultimately, the work is all done in lower level services, such as the MutableAuthenticationService -->
    
    <bean id="baseResetPasswordDelegate" parent="baseJavaDelegate" abstract="true">
        <property name="sysAdminParams" ref="sysAdminParams"/>
    </bean>
    
    <bean id="ResetPasswordPathDelegate" parent="baseResetPasswordDelegate"
         class="org.alfresco.module.org_alfresco_module_cloud.users.ResetPasswordPathDelegate">
        <property name="registrationService" ref="RegistrationService"/>
    </bean>
    
    <bean id="SendActivationReminderEmailDelegate" parent="baseResetPasswordDelegate"
         class="org.alfresco.module.org_alfresco_module_cloud.users.SendActivationReminderEmailDelegate">
        <property name="registrationService" ref="RegistrationService"/>
        <property name="workflowService" ref="WorkflowService"/>
    </bean>
    
    <bean id="SendRegistrationOrLoginEmailDelegate" parent="baseResetPasswordDelegate"
         class="org.alfresco.module.org_alfresco_module_cloud.users.SendRegistrationOrLoginEmailDelegate">
         <property name="emailSender" value="noreply@alfresco.com"/> <!-- TODO Externalise -->
         <property name="emailHelper" ref="cloudEmailHelper"/>
         <property name="signupUrl" value="${cloud.signup.url}"/>
    </bean>
    
    <bean id="SendResetPasswordEmailDelegate" parent="baseResetPasswordDelegate"
         class="org.alfresco.module.org_alfresco_module_cloud.users.SendResetPasswordEmailDelegate">
         <property name="emailSender" value="noreply@alfresco.com"/> <!-- TODO Externalise -->
         <property name="emailHelper" ref="cloudEmailHelper"/>
    </bean>
    
    <bean id="PerformResetPasswordDelegate" parent="baseResetPasswordDelegate"
         class="org.alfresco.module.org_alfresco_module_cloud.users.PerformResetPasswordDelegate">
         <property name="authenticationService" ref="AuthenticationService"/>
         <property name="taskService" ref="activitiTaskService"/>
    </bean>
    
    <!--  I18n resources -->
    <bean id="resetPasswordResourceBundles" class="org.alfresco.i18n.ResourceBundleBootstrapComponent">
        <property name="resourceBundles">
            <list>
                <value>alfresco.messages.reset-password</value>
            </list>
        </property>
   </bean>
    
</beans>
