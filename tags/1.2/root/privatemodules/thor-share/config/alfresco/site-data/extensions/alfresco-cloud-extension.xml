<extension>
   <modules>

      <module>
         <id>Alfresco :: Cloud - Core (1)</id>
         <auto-deploy>true</auto-deploy>

         <!-- Always pass evaluation -->
         <evaluator type="default.extensibility.evaluator"/>

         <!-- Apply the following webscript customizations when the base evaluator above passes -->
         <customizations>

            <customization>
               <targetPackageRoot>org.alfresco</targetPackageRoot>
               <sourcePackageRoot>org.alfresco.cloud.core.customizations</sourcePackageRoot>
            </customization>

            <!-- This ensures that full Aikau pages always have the standard header customization
                applied to them -->
            <customization>
               <targetPackageRoot>org.alfresco.share.pages</targetPackageRoot>
               <sourcePackageRoot>org.alfresco.cloud.core.customizations.share.header</sourcePackageRoot>
               <alwaysApply>
                  <webscript>share-header</webscript>
               </alwaysApply>
            </customization>

            <!-- This handles full Aikau page customizations, e.g. faceted-search -->
            <customization>
               <targetPackageRoot>org.alfresco.share.pages</targetPackageRoot>
               <sourcePackageRoot>org.alfresco.cloud.core.aikau.customizations</sourcePackageRoot>
               <alwaysApply>
                  <webscript>myalfresco-analytics</webscript>
               </alwaysApply>
            </customization>

         </customizations>

         <!-- Apply the following component bindings when the base evaluator above passes -->
         <components>

            <!-- Remove Document Permissions panel -->
            <component>
               <scope>template</scope>
               <region-id>document-permissions</region-id>
               <source-id>document-details</source-id>
               <sub-components>
                  <sub-component id="default">
                     <evaluations>
                        <evaluation id="cloud-core-document-permissions-removed">
                           <render>false</render>
                        </evaluation>
                     </evaluations>
                  </sub-component>
              </sub-components>
            </component>

            <!-- Remove Document Links panel -->
            <component>
               <scope>template</scope>
               <region-id>document-links</region-id>
               <source-id>document-details</source-id>
               <sub-components>
                  <sub-component id="default">
                     <evaluations>
                        <evaluation id="cloud-core-document-links-removed">
                           <render>false</render>
                        </evaluation>
                     </evaluations>
                  </sub-component>
               </sub-components>
            </component>

            <component>
               <scope>template</scope>
               <region-id>folder-links</region-id>
               <source-id>folder-details</source-id>
               <sub-components>
                  <sub-component id="default">
                     <evaluations>
                        <evaluation id="cloud-core-folder-links-removed">
                           <render>false</render>
                        </evaluation>
                     </evaluations>
                  </sub-component>
               </sub-components>
            </component>

            <!-- Remove Folder Permissions panel -->
            <component>
               <scope>template</scope>
               <region-id>folder-permissions</region-id>
               <source-id>folder-details</source-id>
               <sub-components>
                  <sub-component id="default">
                     <evaluations>
                        <evaluation id="cloud-core-folder-permissions-removed">
                           <render>false</render>
                        </evaluation>
                     </evaluations>
                  </sub-component>
              </sub-components>
            </component>

            <!-- Remove Publishing History panel -->
            <component>
               <scope>template</scope>
               <region-id>document-publishing</region-id>
               <source-id>document-details</source-id>
               <sub-components>
                  <sub-component id="default">
                     <evaluations>
                        <evaluation id="cloud-core-publishing-removed">
                           <render>false</render>
                        </evaluation>
                     </evaluations>
                  </sub-component>
              </sub-components>
            </component>

            <!-- Add strength meter and minimum password length consistency to change password-->
            <component>
               <scope>template</scope>
               <region-id>change-password</region-id>
               <source-id>change-password</source-id>
               <sub-components>
                  <sub-component id="default">
                     <url>/cloud/core/components/account/change-password</url>
                  </sub-component>
              </sub-components>
            </component>

            <component>
               <scope>template</scope>
               <region-id>categories</region-id>
               <source-id>documentlibrary</source-id>
               <sub-components>
                  <sub-component id="default">
                     <evaluations>
                        <evaluation id="doclib-categories-removed">
                           <render>false</render>
                        </evaluation>
                     </evaluations>
                  </sub-component>
              </sub-components>
            </component>
         </components>

         <configurations>
            <config evaluator="string-compare" condition="WebFramework" replace="false">
               <web-framework>
                  <dojo-pages>
                     <packages>
                        <package name="myalfresco" location="js/myalfresco"/>
                     </packages>
                  </dojo-pages>
               </web-framework>
            </config>
         </configurations>
      </module>

      <module>
         <id>Alfresco :: Cloud - Free (2)</id>
         <auto-deploy>true</auto-deploy>

         <!-- Only pass evaluation for Public Free (-1) & Private Free (0) accounts -->
         <evaluator type="cloud-account.module.evaluator">
            <params>
               <accountClassNames>PUBLIC_EMAIL_DOMAIN|PRIVATE_EMAIL_DOMAIN</accountClassNames>
            </params>
         </evaluator>

         <!-- Apply the following webscript customizations when the base evaluator above passes -->
         <customizations>

            <customization>
               <targetPackageRoot>org.alfresco</targetPackageRoot>
               <sourcePackageRoot>org.alfresco.cloud.free.customizations</sourcePackageRoot>
            </customization>

            <!-- This ensures that full Aikau pages always have the standard header customization
                applied to them -->
            <customization>
               <targetPackageRoot>org.alfresco.share.pages</targetPackageRoot>
               <sourcePackageRoot>org.alfresco.cloud.free.customizations.share.header</sourcePackageRoot>
               <alwaysApply>
                  <webscript>share-header</webscript>
               </alwaysApply>
            </customization>

         </customizations>

         <!-- Apply the following component bindings when the base evaluator above passes -->
         <components>

            <!-- Replace Console tools with upgrade component -->
            <component>
               <scope>page</scope>
               <region-id>ctool</region-id>
               <source-id>cloud-console</source-id>
               <sub-components>
                  <sub-component id="default">
                     <evaluations>
                        <evaluation id="cloud-free-application-requires-upgrade">
                           <evaluators>
                              <evaluator type="equals.component.evaluator">
                                 <params>
                                    <toolid>{toolid}</toolid>
                                    <application>application</application>
                                 </params>
                              </evaluator>
                           </evaluators>
                           <url>/cloud/core/components/console/upgrade</url>
                        </evaluation>
                        <evaluation id="cloud-free-trashcan-requires-upgrade">
                           <evaluators>
                              <evaluator type="equals.component.evaluator">
                                 <params>
                                    <toolid>{toolid}</toolid>
                                    <trashcan>trashcan</trashcan>
                                 </params>
                              </evaluator>
                           </evaluators>
                           <url>/cloud/core/components/console/upgrade</url>
                        </evaluation>
                        <evaluation id="cloud-free-manage-users-requires-upgrade">
                           <evaluators>
                              <evaluator type="equals.component.evaluator">
                                 <params>
                                    <toolid>{toolid}</toolid>
                                    <application>manage-users</application>
                                 </params>
                              </evaluator>
                           </evaluators>
                           <url>/cloud/core/components/console/upgrade</url>
                        </evaluation>
                        <evaluation id="cloud-free-saml-settings-requires-upgrade">
                           <evaluators>
                              <evaluator type="equals.component.evaluator">
                                 <params>
                                    <toolid>{toolid}</toolid>
                                    <application>saml-settings</application>
                                 </params>
                              </evaluator>
                           </evaluators>
                           <url>/cloud/core/components/console/upgrade</url>
                        </evaluation>
                        <evaluation id="cloud-free-manage-sites-requires-upgrade">
                           <evaluators>
                              <evaluator type="equals.component.evaluator">
                                 <params>
                                    <toolid>{toolid}</toolid>
                                    <application>manage-sites</application>
                                 </params>
                              </evaluator>
                           </evaluators>
                           <url>/cloud/core/components/console/upgrade</url>
                        </evaluation>
                     </evaluations>
                  </sub-component>
               </sub-components>
            </component>

         </components>

      </module>
      
      <module>
         <id>Alfresco :: Cloud - GetSatisfaction</id>
         <auto-deploy>true</auto-deploy>

         <evaluator type="default.extensibility.evaluator"/>

         <components>
            <component>
               <scope>global</scope>
               <region-id>footer</region-id>
               <source-id>global</source-id>
               <sub-components>
                  <sub-component id="GetSatisfaction" index="75">
                     <url>/cloud/core/components/feedback/get-satisfaction</url>
                  </sub-component>
               </sub-components>
            </component>
         </components>
      </module>
      
      <module>
         <id>Alfresco :: Cloud - GoSquared</id>
         <auto-deploy>true</auto-deploy>

         <evaluator type="default.extensibility.evaluator"/>

         <components>
            <component>
               <scope>global</scope>
               <region-id>footer</region-id>
               <source-id>global</source-id>
               <sub-components>
                  <sub-component id="GoSquared" index="80">
                     <url>/cloud/core/components/feedback/go-squared</url>
                  </sub-component>
               </sub-components>
            </component>
         </components>
      </module>
      
      <module>
         <id>Alfresco :: Cloud - New Relic</id>
         <auto-deploy>true</auto-deploy>

         <evaluator type="default.extensibility.evaluator"/>

         <components>
            <!-- Login Page -->
            <component>
               <scope>page</scope>
               <region-id>components</region-id>
               <source-id>slingshot-login</source-id>
               <sub-components>
                  <sub-component id="NewRelicHeader" index="1">
                     <url>/cloud/core/components/feedback/header</url>
                  </sub-component>
                  <sub-component id="NewRelicFooter" index="99">
                     <url>/cloud/core/components/feedback/footer</url>
                  </sub-component>
               </sub-components>
            </component>
            <!--  Everything Else -->
            <component>
               <scope>global</scope>
               <region-id>header</region-id>
               <source-id>global</source-id>
               <sub-components>
                  <sub-component id="NewRelicHeader" index="1">
                     <url>/cloud/core/components/feedback/header</url>
                  </sub-component>
               </sub-components>
            </component>
            <component>
               <scope>global</scope>
               <region-id>footer</region-id>
               <source-id>global</source-id>
               <sub-components>
                  <sub-component id="NewRelicFooter" index="99">
                     <url>/cloud/core/components/feedback/footer</url>
                  </sub-component>
               </sub-components>
            </component>
         </components>
      </module>

      <!-- Completely disabled live search feature -->
      <module>
         <id>Alfresco :: Cloud - Disable Live Search</id>
         <auto-deploy>false</auto-deploy>
         <evaluator type="default.extensibility.evaluator"/>
         <customizations>
            <customization>
               <targetPackageRoot>org.alfresco</targetPackageRoot>
               <sourcePackageRoot>org.alfresco.cloud.core.customizations.livesearch.disable</sourcePackageRoot>
            </customization>
            <customization>
               <targetPackageRoot>org.alfresco.share.pages</targetPackageRoot>
               <sourcePackageRoot>org.alfresco.cloud.core.customizations.livesearch.disable.share.header</sourcePackageRoot>
               <alwaysApply>
                  <webscript>share-header</webscript>
               </alwaysApply>
            </customization>
         </customizations>
      </module>

      <!-- Limits live search to just the Alfresco network -->
      <module>
         <id>Alfresco :: Cloud - Limit Live Search</id>
         <auto-deploy>false</auto-deploy>
         <evaluator type="default.extensibility.evaluator"/>
         <customizations>
            <customization>
               <targetPackageRoot>org.alfresco</targetPackageRoot>
               <sourcePackageRoot>org.alfresco.cloud.core.customizations.livesearch.limit</sourcePackageRoot>
            </customization>
            <customization>
               <targetPackageRoot>org.alfresco.share.pages</targetPackageRoot>
               <sourcePackageRoot>org.alfresco.cloud.core.customizations.livesearch.limit.share.header</sourcePackageRoot>
               <alwaysApply>
                  <webscript>share-header</webscript>
               </alwaysApply>
            </customization>
         </customizations>
      </module>

      <!-- Completely disabled faceted search feature -->
      <module>
         <id>Alfresco :: Cloud - Disable Faceted Search</id>
         <auto-deploy>false</auto-deploy>
         <evaluator type="default.extensibility.evaluator"/>
         <customizations>
            <customization>
               <targetPackageRoot>org.alfresco</targetPackageRoot>
               <sourcePackageRoot>org.alfresco.cloud.core.customizations.faceted-search.disable</sourcePackageRoot>
            </customization>
            <customization>
               <targetPackageRoot>org.alfresco.share.pages</targetPackageRoot>
               <sourcePackageRoot>org.alfresco.cloud.core.customizations.faceted-search.disable.share.header</sourcePackageRoot>
               <alwaysApply>
                  <webscript>share-header</webscript>
               </alwaysApply>
            </customization>
         </customizations>
      </module>

      <!-- Limits faceted search to just the Alfresco network -->
      <module>
         <id>Alfresco :: Cloud - Limit Faceted Search</id>
         <auto-deploy>false</auto-deploy>
         <evaluator type="default.extensibility.evaluator"/>
         <customizations>
            <customization>
               <targetPackageRoot>org.alfresco</targetPackageRoot>
               <sourcePackageRoot>org.alfresco.cloud.core.customizations.faceted-search.limit</sourcePackageRoot>
            </customization>
            <customization>
               <targetPackageRoot>org.alfresco.share.pages</targetPackageRoot>
               <sourcePackageRoot>org.alfresco.cloud.core.customizations.faceted-search.limit.share.header</sourcePackageRoot>
               <alwaysApply>
                  <webscript>share-header</webscript>
               </alwaysApply>
            </customization>
         </customizations>
      </module>

   </modules>
</extension>
